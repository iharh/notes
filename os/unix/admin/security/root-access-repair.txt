Шпаргалка: Обход ограничений root и восстановление пароля root в Linux  

I. Временное получение прав root через sudo  
Если root-заблокирован, но есть sudo-пользователь:  

sudo su -

Или выполнить команду от имени root:  

sudo -i

Если sudo не настроен для пользователя:  

su - root

(Требуется пароль root, если не установлен — переходи к следующему пункту)  



II. Восстановление пароля root через режим восстановления (Recovery Mode)  
1. Перезагрузи систему и на экране GRUB выбери Advanced options → Recovery mode  
2. Выбери пункт root - Drop to root shell prompt  
3. Проверь файловую систему и перемонтируй ее в режим записи:  
   

   mount -o remount,rw /
   
4. Установи новый пароль root:  
   

   passwd root
   
5. Перезагрузи систему:  
   

   reboot
   



3️⃣ Восстановление root-доступа через редактирование GRUB
Если Recovery Mode недоступен, редактируем загрузку GRUB:  
1. Перезагрузи сервер  
2. В меню GRUB выбери нужную ОС и нажми e (Edit)  
3. Найди строку, начинающуюся с linux /boot/... и в конце допиши:  
   

   init=/bin/bash
   
4. Нажми Ctrl + X или F10 для загрузки  
5. Перемонтируй файловую систему:  
   

   mount -o remount,rw /
   
6. Сбрось пароль root:  
   

   passwd root
   
7. Перезагрузи систему:  
   

   exec /sbin/init
   



4️⃣ Восстановление root через LiveCD / LiveUSB  
Если не удается получить доступ через GRUB, используй загрузочный Linux (LiveCD):  
1. Загрузи систему с LiveCD (Ubuntu, Debian, Kali и т. д.)  
2. Определи диск с установленной ОС:  
   

   fdisk -l
   
3. Подключи диск:  
   

   mount /dev/sdXn /mnt
   
4. Перейди в среду chroot:  
   

   chroot /mnt
   
5. Сбрось пароль root:  
   

   passwd root
   
6. Перезагрузи систему:  
   

   reboot
   



5️⃣ Восстановление root-доступа в системах с SELinux  
Если включен SELinux, после сброса пароля root обязательно обнови контекст:  

touch /.autorelabel

или  

restorecon -v /etc/shadow




6️⃣ Полное удаление пароля root  
Если хочешь полностью удалить пароль root, используй команду:  

passwd -d root

После этого можно зайти под root без пароля.



⚠️ Важно!  
- Используй эти методы только на своих серверах.  
- При потере root-доступа заблаговременно настрой sudo или создай резервного пользователя.  
- В корпоративных системах возможны дополнительные ограничения (LDAP, PAM, Secure Boot).  
