*****************************************************************************
–ï—Å–ª–∏ —É –≤–∞—Å –≤ PostgreSQL –≤–∫–ª—é—á–µ–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, —Ç–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, –≤ —Ü–µ–ª—è—Ö –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ. –ß—Ç–æ —Ç–∞–∫–æ–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –∫–∞–∫ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –±—É–¥–µ–º —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ —ç—Ç–æ–π –∑–∞–º–µ—Ç–∫–µ.

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–∞–∫: –∑–∞–ø—Ä–æ—Å —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–µ–π –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ñ–æ–Ω–æ–≤—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –§–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –æ–±—â–∞—é—Ç—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π —á–µ—Ä–µ–∑ –æ–±—â–∏–π –±—É—Ñ—É–µ—Ä. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –∫–∞–∂–¥–∞—è —á–∞—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –∞–∫–∫–æ–º—É–ª–∏—Ä–æ–≤–∞–Ω –∏ –ø–µ—Ä–µ–¥–∞–Ω –≤–µ–¥—É—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É.

–†–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–º–∞–Ω–¥—ã EXPLAIN –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ –≤–æ—Ç —Ç–∞–∫:

Gather (cost=0.00..46010.00 rows=1000000 width=43)
Workers Planned: 4
Workers Launched: 4
-> Parallel Seq Scan on my_table (cost=0.00..44010.00 rows=230000 width=43)

–í–º–µ—Å—Ç–æ Gather –µ—â–µ –º–æ–∂–µ—Ç –±—ã—Ç—å Gather Merge. –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞, —Ä–∞–∑–±–µ—Ä–µ–º—Å—è –¥–∞–ª—å—à–µ.

–ó–¥–µ—Å—å Gather –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–º, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –±—ã–ª —Å–æ–±—Ä–∞–Ω –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, Workers Planned - —Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –±—ã–ª–æ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º –∑–∞–ø—Ä–æ—Å–æ–≤, Workers Launched - —Å–∫–æ–ª—å–∫–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ.

–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Gather –∏ Gather Merge –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ Gather Merge —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (ORDER BY), —Ç.–µ. –∫–æ–≥–¥–∞ –∫–∞–∂–¥—ã–π –∏–∑ —Ñ–æ–Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Å–≤–æ–µ–π —á–∞—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–ª–∏—è–Ω–∏—è –≤–µ–¥—É—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É. Gather –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö –±–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏.

–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Ñ–∞–π–ª–µ postgresql.conf, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä—ã—Ö –º—ã –º–æ–∂–µ–º —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤:

max_worker_processes - –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –æ–±—â–µ–µ –∫–æ–ª-–≤–æ —Ñ–æ–Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤—Å–µ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É PostgreSQL;

max_parallel_workers - –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –æ–±—â–µ–µ –∫–æ–ª-–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤—Å–µ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É PostgreSQL –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤. –ó–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–∏–º –∏–ª–∏ —Ä–∞–≤–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ max_worker_processes;

max_parallel_workers_per_gather - –∑–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–æ–ª-–≤–æ —Ñ–æ–Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

–ï—Å—Ç—å –µ—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä—ã—Ö –º—ã –º–æ–∂–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:

parallel_setup_cost - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –æ–¥–Ω–æ–≥–æ —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –≤—ã–¥–µ–ª–µ–Ω–∏—è –µ–º—É –ø–∞–º—è—Ç–∏. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1000;

parallel_tuple_cost - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ñ–æ–Ω–æ–≤—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.1.

–ê –µ—â–µ –º—ã –º–æ–∂–µ–º —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ç–∞–±–ª–∏—Ü –∏ –∏–Ω–¥–µ–∫—Å–æ–≤:

min_parallel_table_scan_size - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º PostgreSQL –ø—Ä–∏–º–µ—Ç —Ä–µ—à–µ–Ω–∏–µ –æ –µ–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏. –ó–Ω–∞—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ –±–∞–π—Ç–∞—Ö, –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - 8MB. –¢.–µ. –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å—Å—è –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞—Ö, –æ–±—ä–µ–º –∫–æ—Ç–æ—Ä—ã—Ö –º–µ–Ω—å—à–µ 8MB;

min_parallel_index_scan_size - —Ç–æ–∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä, —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω–¥–µ–∫—Å–æ–≤. –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8MB.

–ê –µ—â–µ –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä force_parallel_mode (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é OFF) –∏ —Ç–æ–≥–¥–∞ PostgreSQL –±—É–¥–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—å –≤—Å–µ —á—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ. –ù–æ –Ω–∞ —Ä–∞–±–æ—á–µ–º –∫–ª–∞—Å—Ç–µ—Ä–µ –ª—É—á—à–µ —Ç–∞–∫ –Ω–µ –¥–µ–ª–∞—Ç—å, —Ç–∞–∫ –∫–∞–∫ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã–µ –Ω—é–∞–Ω—Å—ã.

–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏ OLAP –Ω–∞–≥—Ä—É–∑–∫–µ, —Ç.–µ. –∫–æ–≥–¥–∞ —É –≤–∞—Å –≤ –±–∞–∑–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –¥–æ–ª–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞–∫–æ–≥–æ-–Ω–∏–±—É–¥—å –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—á–µ—Ç–∞. –ö–æ–≥–¥–∞ —É –≤–∞—Å –º–Ω–æ–≥–æ –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–∑–¥–∞—é—Ç, –æ–±–Ω–æ–≤–ª—è—é—Ç –∏–ª–∏ —É–¥–∞–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ, —Ç.–µ. OLTP –Ω–∞–≥—Ä—É–∑–∫–∞, —Ç–æ —Ç–æ–ª–∫—É –æ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –±—É–¥–µ—Ç –º–∞–ª–æ, –∏–ª–∏ –Ω–µ –±—É–¥–µ—Ç –≤–æ–æ–±—â–µ. 

–î–ª—è –ø—Ä–æ–≥—Ä–∞–º–º —Å–µ–º–µ–π—Å—Ç–≤–∞ 1—Å –≤–æ–æ–±—â–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –æ—Ç–∫–ª—é—á–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º, —Ç.–µ. —Å—Ç–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä max_parallel_workers_per_gather –≤ –Ω–æ–ª—å, –Ω–æ —Ç—É—Ç –≤—Å–µ –Ω–µ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ –º–æ–≥—É—Ç –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –∏ —Ç–∏–ø–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

–û –Ω—é–∞–Ω—Å–∞—Ö –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –µ—â—ë —Ä–∞—Å—Å–∫–∞–∂–µ–º –≤ –±—É–¥—É—â–∏—Ö –ø–æ—Å—Ç–∞—Ö üòâ.
