2025
https://sqlfordevs.com/for-each-loop-lateral-join

*******************************************
–°–µ–≥–æ–¥–Ω—è —Ä–∞—Å—Å–∫–∞–∂—É –≤–∞–º –ø—Ä–æ –æ–¥–Ω—É —á–∞—Å—Ç–æ –Ω–µ–¥–æ–æ—Ü–µ–Ω—ë–Ω–Ω—É—é, –Ω–æ –∫—Ä–∞–π–Ω–µ –ø–æ–ª–µ–∑–Ω—É—é SQL-—Ñ–∏—à–∫—É ‚Äî CROSS APPLY –≤ SQL Server (–∏ –µ–≥–æ –∞–Ω–∞–ª–æ–≥ –≤ –¥—Ä—É–≥–∏—Ö –°–£–ë–î ‚Äî LATERAL).

–ö–æ–≥–¥–∞ –æ–±—ã—á–Ω—ã–π JOIN –±–µ—Å—Å–∏–ª–µ–Ω

–î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ Orders, –∏ –º—ã —Ö–æ—Ç–∏–º –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ø-1 –ø—Ä–æ–¥—É–∫—Ç –ø–æ —Å—É–º–º–µ, –Ω–æ –≤—ã–±–æ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç—Ä–æ–∫–∏ ‚Äî —Ç—É—Ç —É–∂–µ –æ–±—ã—á–Ω—ã–π JOIN –Ω–µ —Å–ø—Ä–∞–≤–∏—Ç—Å—è. –í–æ—Ç –ø—Ä–∏–º–µ—Ä, –≥–¥–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞ –ø–æ–º–æ—â—å CROSS APPLY:


SELECT 
    o.OrderID,
    p.ProductName,
    p.Amount
FROM Orders o
CROSS APPLY (
    SELECT TOP 1 *
    FROM Products p
    WHERE p.OrderID = o.OrderID
    ORDER BY p.Amount DESC
) p;


–ß—Ç–æ –¥–µ–ª–∞–µ—Ç CROSS APPLY?

–û–Ω –±—É–∫–≤–∞–ª—å–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç: ¬´–î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –∏–∑ Orders –≤—ã–ø–æ–ª–Ω–∏ –ø–æ–¥–∑–∞–ø—Ä–æ—Å —Å –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏¬ª. –≠—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ foreach, –≥–¥–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –≤—ã–±–æ—Ä–∫–∞ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç—Ä–æ–∫–∏ –≤–Ω–µ—à–Ω–µ–π —Ç–∞–±–ª–∏—Ü—ã.

–ê–Ω–∞–ª–æ–≥ –≤ PostgreSQL:


SELECT 
    o.order_id,
    p.product_name,
    p.amount
FROM orders o,
LATERAL (
    SELECT *
    FROM products p
    WHERE p.order_id = o.order_id
    ORDER BY p.amount DESC
    LIMIT 1
) p;




üî• –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CROSS APPLY, –∫–æ–≥–¥–∞:
- –ù—É–∂–Ω–∞ –ø–æ–¥—Å—Ç—Ä–æ—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤–Ω—É—Ç—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞
- –ù–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π JOIN
- –í—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ç–∞–±–ª–∏—Ü—É (TVF)
