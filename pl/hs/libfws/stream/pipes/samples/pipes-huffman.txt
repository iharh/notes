http://blog.jle.im/entry/pipes-streaming-huffman-compression-in-haskell-part-3
