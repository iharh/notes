64Mb 2sec

Имеется K (1 <= K <= 10,000) запросов.
Каждый из них имеет две части:
Первая из них C_i - команда - либо буква 'P' либо буква 'Q'.  
Если С_i  есть 'P' то вторая часть - одно целое число - A_i (1 <= A_i <= N!), номер перестановки, которую нужно вывести
Если C_i есть 'Q' то вторая часть запроса - N различных целых чисел B_ij (1 <= B_ij <= N<=20) – перестановка, 
                  для которой нужно вывести её номер в лексикографическом порядке. 

Например 
P 3

Перестановки в лексикографическом порядке:
1: 1 2 3 4 5
2: 1 2 3 5 4
3: 1 2 4 3 5

Поэтому ответ на данный запрос 
1 2 4 3 5

Ещё пример
Q 1 2 5 3 4

Требуется вывести номер этой перестановки

Продолжая список:
4 : 1 2 4 5 3
5 : 1 2 5 3 4

Ответ должен быть 5.


Формат ввода

* Строка 1: Два разделенных пробелом целых числа: N и K
* Строки 2..2*K+1: Строки 2*i и 2*i+1 содержат по одному запросу.
Строка 2*i содержит только один символ 
'Q' если требуется  число - номер заданной перестановки, и 
'P' если требуется вывести перестановку по заданному её номеру
Если строка 2*i есть 'Q', то строка 2*i+1 будет содержать N разделенных 
пробелом целых чисел B_ij, которые представляют перестановку
Если строка 2*i есть 'P', то строка 2*i+1 будет содержать одно целое число
A_i - номер перестановки, которую нужно вывести

Формат вывода

* строки 1..K: Строка i должна содержать ответ на запрос i.
Если строка 2*i была 'Q', то эта строка должна содержать одно целое число - номер перестановки, в которой стояли коровы в строке 2*i+1.
Если строка 2*i была 'P', то эта строка будет содержать N разделенных пробелом целых чисел, определяющих перестановку коров с номером, 
указанным в строке 2*i+1

Пример ввода (файл line.in):
5 2
P
3
Q
1 2 5 3 4

Пример вывода (файл line.out):
1 2 4 3 5
5
