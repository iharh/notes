64Mb 2sec

В этом пазле имеется R (1 <= R <= 10) и C (1 <= C <= 10) столбцов, а края соединяются не формой, а буквами.
Каждый квадратик пазла имеет число (последовательный номер) внутри и 4 буквы (или внешние границы, обозначенные цифрой 0 у нас).
Кусок пазла может иметь не более двух границ (угловой кусок).

Ниже представлено множество из 6 кусков (границы помечены символами линий вместо 0), собранных одним из множества способов в пазл:

              +---+  +---+  +---+
              | 1 c  c 3 d  d 5 |
              +-d-+  + a +  +-e-+

              +-d-+  +-a-+  +-e-+
              | 2 b  b 4 b  b 6 |
              +---+  +---+  +---+

Заметим, что крайние буквы соседних кусков одинаковые, а границы появляются только сверху/снизу и по сторонам пазла.
Куски пазлов задаются своми последовательными номерами и списком их четырех границ в порядке обхода по часовой стрелке
(граница – это либо символ от a до z, либо 0).
По заданному описанию кусков пазла, найдите хотя бы один способ собрать эти куски в пазл.

Формат ввода

* Строка 1: Два разделенных пробелом целых числа: R и C
* Строки 2..R*C+1: Каждая строка содержит 5 разделенных пробелом сущностей - последовательный номер и 4 идентификатора границы
Формат вывода

* Строки 1..R*C: Строка R*(i-1)+j описывает кусок пазла, который необходимо разместить на позицию строка i, колонка j
                 с помощью одного целого числа и четырех идентификаторов границ: верхней, правой, нижней, левой.


Пример ввода (файл jigsaw.in)
2 3
1 c d 0 0
2 0 d b 0
3 c 0 d a
4 b a b 0
5 d 0 0 e
6 0 0 b e


Пример вывода (файл jigsaw.out)
1 0 c d 0
3 0 d a c
5 0 0 e d
2 d b 0 0
4 a b 0 b
6 e 0 0 b


Пояснения
На вводе описывается входной пазл, при этом некоторые куски могут быть повернуты относительно приведенного решения.
Ответ соответствует диаграмме, приведенной в тексте задачи.
Другие решения (такие, как отражения) возможны.
Специальный чекер написан для проверки Ваших решений.
