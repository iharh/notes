256Mb 2sec

Имеется N (1<=N<=15) островов, которые расположены на решетке R x C (1 <= R, C <= 50).
Остров - это максимальная связная группа квадратов на решетке, помеченная символами 'X',
где два 'X' связны, только если они имеют общую сторону.
Квадраты, имеющие общий угол, не обязательно связны.

Путешественник прилетает на вертолете.
Он может приземлиться на любом острове.
Он хочет посетить все N островов хотя бы один раз.

Вокруг островов находится мелководье (обозначено буквой 'S').
Путешественник может плыть по нему в четырех направлениях (север, юг, запад, восток) для того, чтобы перемещаться между островами.
Он также может перемешаться между островом и мелководьем и наоборот.

Определите минимальное расстояние, которое Путешественник должен проплыть, чтобы посетить все острова (гарантируется, что это возможно).
Расстояние, которое проплывет Путешественник, равно количеству различных раз, когда Беси посетит клеточку 'S'.


Формат ввода

* Строка 1: Два разделенных пробелом целых числа: R и C.

* Строки 2..R+1: Строка i+1 содержит C символов, определяющих i-ую строку
            решетки. Глубокая вода обозначена '.', острова 'X', мелководье 'S'.

Пример ввода

5 4
XX.S
.S..
SXSS
S.SX
..SX

Пояснения ко вводу

Имеется 3 острова, некоторые из которых имеют пути из мелководья.

Формат вывод

* Строка 1: Одно целое число, представляющее минимальное расстояние,
            которое должен проплыть рутешственник, чтобы посетить все острова.

Пример вывода

3

Пояснения к выводу

Путешественник может проплыть от левого верхнего сотрова к среднему,
проплыв 1 клеточку, а затем от среднего острова к правому нижнему,
проплыв 2 клеточки - всего 3.
