64Mb 2sec

Рис. 1. План улиц для гонки

На рис.1 изображен пример плана улиц для гонки.
Вы видите точки, помеченные числами от 0 до N (где N=9), а также стрелки, соединяющие их.
Точка 0 является стартовой; точка N - финишной.
Стрелками представлены улицы с односторонним движением.
Участники гонки передвигаются от точки к точке по улицам только в направлении стрелок.
В каждой точке участник гонки может выбрать любую из исходящих стрелок.

Назовем план улиц хорошим, если он обладает следующими свойствами:

Каждая точка плана может быть достигнута со старта.
Финиш может быть достигнут из любой точки плана.
У финиша нет исходящих стрелок.
       
Для достижения финиша участник не обязан пройти через все точки.
Однако некоторые точки невозможно обойти.
Назовем их неизбежными.
В примере такими точками являются точки 0, 3, 6, 9.

Для заданного хорошего плана Ваша программа должна определить множество неизбежных точек (за исключением старта и финиша),
которые должны посетить все участники (подзадача А).

Предположим,что гонка должна проводиться за два последовательных дня.
Для этой цели план должен быть разбит на два хороших плана, по одному на каждый день.
В первый день стартом является точка 0, а финишем служит некая "точка разбиения".
Во второй день старт находится в этой точке разбиения,а финиш находится в точке N.
Для заданного хорошего плана Ваша программа должна определить множество всех возможных точек разбиения (подзадача В).

Точка S является точкой разбиения для хорошего плана С, если S отличается от старта и финиша С,
и план разбивается ею на два хороших плана без общих стрелок и с единственной общей точкой S.
В примере точкой разбиения является точка 3.

Входные данные

В файле input.txt описан хороший план, содержащий не более 50 точек и не более 100 стрелок.
В файле имеется N+1 строка.
Первые N строк содержат конечные точки стрелок, исходящих соответственно из точек от 0 до N-1.
Каждая из этих строк заканчивается числом -2. В последней строке содержится число -1.

Выходные данные

Ваша программа должна записать две строки в файл output.txt.
Первая строка должна содержать количество неизбежных точек в заданном плане,
после чего в той же строке должны следовать номера этих точек в любом порядке (подзадача А).
Вторая строка должна содержать количество точек в заданном плане, за которым в той же строке должны следовать номера этих точек в любом порядке (подзадача В).

Пример ввода и вывода

input.txt

1 2 -2
3 -2
3 -2
5 4 -2
6 4 -2
6 -2
7 8 -2
9 -2
5 9 -2
-1

output.txt

2 3 6
1 3
